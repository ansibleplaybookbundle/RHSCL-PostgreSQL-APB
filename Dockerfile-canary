FROM ansibleplaybookbundle/apb-base:canary
MAINTAINER Ansible Playbook Bundle Community

LABEL "com.redhat.apb.spec"=\
"LS0tCgp2ZXJzaW9uOiAxLjAKbmFtZTogcG9zdGdyZXNxbC1hcGIKZGVzY3JpcHRpb246IFNDTCBQ\
b3N0Z3JlU1FMIGFwYiBpbXBsZW1lbnRhdGlvbgpiaW5kYWJsZTogdHJ1ZQphc3luYzogb3B0aW9u\
YWwKdGFnczoKICAtIGRhdGFiYXNlCiAgLSBwb3N0Z3Jlc3FsCm1ldGFkYXRhOgogIGRvY3VtZW50\
YXRpb25Vcmw6IGh0dHBzOi8vd3d3LnBvc3RncmVzcWwub3JnL2RvY3MvCiAgbG9uZ0Rlc2NyaXB0\
aW9uOiBBbiBhcGIgdGhhdCBkZXBsb3lzIHBvc3RncmVzcWwgOS41LCA5LjYgb3IgMTAuCiAgZGVw\
ZW5kZW5jaWVzOgogICAgLSAnZG9ja2VyLmlvL2NlbnRvcy9wb3N0Z3Jlc3FsLTk1LWNlbnRvczcn\
CiAgICAtICdkb2NrZXIuaW8vY2VudG9zL3Bvc3RncmVzcWwtOTYtY2VudG9zNycKICAgIC0gJ2Rv\
Y2tlci5pby9jZW50b3MvcG9zdGdyZXNxbC0xMC1jZW50b3M3JwogIGRpc3BsYXlOYW1lOiBQb3N0\
Z3JlU1FMIChBUEIpCiAgY29uc29sZS5vcGVuc2hpZnQuaW8vaWNvbkNsYXNzOiBpY29uLXBvc3Rn\
cmVzcWwKICBwcm92aWRlckRpc3BsYXlOYW1lOiAiUmVkIEhhdCwgSW5jLiIKcGxhbnM6CiAgLSBu\
YW1lOiBkZXYKICAgIGRlc2NyaXB0aW9uOiBBIHNpbmdsZSBEQiBzZXJ2ZXIgd2l0aCBubyBzdG9y\
YWdlCiAgICBmcmVlOiB0cnVlCiAgICBtZXRhZGF0YToKICAgICAgZGlzcGxheU5hbWU6IERldmVs\
b3BtZW50CiAgICAgIGxvbmdEZXNjcmlwdGlvbjoKICAgICAgICBUaGlzIHBsYW4gcHJvdmlkZXMg\
YSBzaW5nbGUgbm9uLUhBIFBvc3RncmVTUUwgc2VydmVyIHdpdGhvdXQKICAgICAgICBwZXJzaXN0\
ZW50IHN0b3JhZ2UKICAgICAgY29zdDogJDAuMDAKICAgIHBhcmFtZXRlcnM6CiAgICAgIC0gbmFt\
ZTogcG9zdGdyZXNxbF9kYXRhYmFzZQogICAgICAgIGRlZmF1bHQ6IGFkbWluCiAgICAgICAgdHlw\
ZTogc3RyaW5nCiAgICAgICAgdGl0bGU6IFBvc3RncmVTUUwgRGF0YWJhc2UgTmFtZQogICAgICAg\
IHBhdHRlcm46ICJeW2EtekEtWl9dW2EtekEtWjAtOV9dKiQiCiAgICAgICAgcmVxdWlyZWQ6IHRy\
dWUKICAgICAgLSBuYW1lOiBwb3N0Z3Jlc3FsX3VzZXIKICAgICAgICBkZWZhdWx0OiBhZG1pbgog\
ICAgICAgIHRpdGxlOiBQb3N0Z3JlU1FMIFVzZXIKICAgICAgICB0eXBlOiBzdHJpbmcKICAgICAg\
ICBtYXhsZW5ndGg6IDYzCiAgICAgICAgcGF0dGVybjogIl5bYS16QS1aX11bYS16QS1aMC05X10q\
JCIKICAgICAgICByZXF1aXJlZDogdHJ1ZQogICAgICAtIG5hbWU6IHBvc3RncmVzcWxfcGFzc3dv\
cmQKICAgICAgICB0eXBlOiBzdHJpbmcKICAgICAgICB0aXRsZTogUG9zdGdyZVNRTCBQYXNzd29y\
ZAogICAgICAgIGRpc3BsYXlfdHlwZTogcGFzc3dvcmQKICAgICAgICBwYXR0ZXJuOiAiXlthLXpB\
LVowLTlffiFAIyQlXiYqKCktPTw+LC4/Ozp8XSskIgogICAgICAgIHJlcXVpcmVkOiB0cnVlCiAg\
ICAgIC0gbmFtZTogcG9zdGdyZXNxbF92ZXJzaW9uCiAgICAgICAgZGVmYXVsdDogJzEwJwogICAg\
ICAgIGVudW06IFsnMTAnLCAnOS42JywgJzkuNSddCiAgICAgICAgdHlwZTogZW51bQogICAgICAg\
IHRpdGxlOiBQb3N0Z3JlU1FMIFZlcnNpb24KICAgICAgICByZXF1aXJlZDogdHJ1ZQogICAgICAg\
IHVwZGF0YWJsZTogdHJ1ZQogICAgdXBkYXRlc190bzoKICAgICAgLSBwcm9kCiAgLSBuYW1lOiBw\
cm9kCiAgICBkZXNjcmlwdGlvbjogQSBzaW5nbGUgREIgc2VydmVyIHdpdGggcGVyc2lzdGVudCBz\
dG9yYWdlCiAgICBmcmVlOiB0cnVlCiAgICBtZXRhZGF0YToKICAgICAgZGlzcGxheU5hbWU6IFBy\
b2R1Y3Rpb24KICAgICAgbG9uZ0Rlc2NyaXB0aW9uOgogICAgICAgIFRoaXMgcGxhbiBwcm92aWRl\
cyBhIHNpbmdsZSBub24tSEEgUG9zdGdyZVNRTCBzZXJ2ZXIgd2l0aAogICAgICAgIHBlcnNpc3Rl\
bnQgc3RvcmFnZQogICAgICBjb3N0OiAkMC4wMAogICAgcGFyYW1ldGVyczoKICAgICAgLSBuYW1l\
OiBwb3N0Z3Jlc3FsX2RhdGFiYXNlCiAgICAgICAgZGVmYXVsdDogYWRtaW4KICAgICAgICB0eXBl\
OiBzdHJpbmcKICAgICAgICB0aXRsZTogUG9zdGdyZVNRTCBEYXRhYmFzZSBOYW1lCiAgICAgICAg\
cGF0dGVybjogIl5bYS16QS1aX11bYS16QS1aMC05X10qJCIKICAgICAgICByZXF1aXJlZDogdHJ1\
ZQogICAgICAtIG5hbWU6IHBvc3RncmVzcWxfdXNlcgogICAgICAgIGRlZmF1bHQ6IGFkbWluCiAg\
ICAgICAgdGl0bGU6IFBvc3RncmVTUUwgVXNlcgogICAgICAgIHR5cGU6IHN0cmluZwogICAgICAg\
IG1heGxlbmd0aDogNjMKICAgICAgICBwYXR0ZXJuOiAiXlthLXpBLVpfXVthLXpBLVowLTlfXSok\
IgogICAgICAgIHJlcXVpcmVkOiB0cnVlCiAgICAgIC0gbmFtZTogcG9zdGdyZXNxbF9wYXNzd29y\
ZAogICAgICAgIHR5cGU6IHN0cmluZwogICAgICAgIHRpdGxlOiBQb3N0Z3JlU1FMIFBhc3N3b3Jk\
CiAgICAgICAgZGlzcGxheV90eXBlOiBwYXNzd29yZAogICAgICAgIHBhdHRlcm46ICJeW2EtekEt\
WjAtOV9+IUAjJCVeJiooKS09PD4sLj87OnxdKyQiCiAgICAgICAgcmVxdWlyZWQ6IHRydWUKICAg\
ICAgLSBuYW1lOiBwb3N0Z3Jlc3FsX3ZlcnNpb24KICAgICAgICBkZWZhdWx0OiAnMTAnCiAgICAg\
ICAgZW51bTogWycxMCcsICc5LjYnLCAnOS41J10KICAgICAgICB0eXBlOiBlbnVtCiAgICAgICAg\
dGl0bGU6IFBvc3RncmVTUUwgVmVyc2lvbgogICAgICAgIHJlcXVpcmVkOiB0cnVlCiAgICAgICAg\
dXBkYXRhYmxlOiB0cnVlCiAgICAgIC0gbmFtZTogcG9zdGdyZXNxbF92b2x1bWVfc2l6ZQogICAg\
ICAgIHR5cGU6IGVudW0KICAgICAgICBkZWZhdWx0OiAnMUdpJwogICAgICAgIGVudW06IFsnMUdp\
JywgJzVHaScsICcxMEdpJ10KICAgICAgICB0aXRsZTogUG9zdGdyZVNRTCBWb2x1bWUgU2l6ZQog\
ICAgICAgIHJlcXVpcmVkOiB0cnVlCiAgICB1cGRhdGVzX3RvOgogICAgICAtIGRldgo="


ADD playbooks /opt/apb/actions

# Add our role into the ansible roles dir
ADD . /opt/ansible/roles/postgresql-apb

RUN chmod -R g=u /opt/{ansible,apb}

USER apb
